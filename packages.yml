version: '{build}'
image: Visual Studio 2015
configuration:
  - Release

install:
# log4cpp
  - ps: Start-FileDownload https://sourceforge.net/projects/log4cpp/files/log4cpp-1.1.x%20%28new%29/log4cpp-1.1/log4cpp-1.1.1.tar.gz/download log4cpp-1.1.1.tar.gz
  - tar -x -f log4cpp-1.1.1.tar.gz -C c:\projects
# jsoncpp
  - ps: Start-FileDownload https://github.com/open-source-parsers/jsoncpp/archive/1.8.0.zip jsoncpp-1.8.0.zip
  - 7z x -bd -oC:\projects jsoncpp-1.8.0.zip
  - move C:\projects\jsoncpp-1.8.0 C:\projects\jsoncpp

before_build:
  - cd c:\projects\jsoncpp
  - cmake .

build_script:
  - msbuild C:\projects\log4cpp\msvc10\msvc10.sln
  - msbuild C:\projects\jsoncpp\jsoncpp.sln

after_build:
  - cd C:\projects 
  - md C:\projects\appveyor-sandbox\artifacts
# log4cpp
  - 7z a log4cpp.zip log4cpp\include log4cpp\msvc10\log4cppLIB\Release\*lib
  - move C:\projects\log4cpp.zip C:\projects\appveyor-sandbox\artifacts
# jsoncpp
  - 7z a jsoncpp.zip jsoncpp\include jsoncpp\src\lib_json\Release\*lib
  - move C:\projects\jsoncpp.zip C:\projects\appveyor-sandbox\artifacts

artifacts:
  - path: artifacts\log4cpp.zip
  - path: artifacts\jsoncpp.zip

